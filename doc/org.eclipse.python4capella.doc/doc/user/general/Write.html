<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<title>Write</title>
		<link type="text/css" rel="stylesheet" href="../../resources/bootstrap.css"/>
		<link type="text/css" rel="stylesheet" href="../../resources/custom.css"/>
	</head>
	<body>
		<h1 id="WriteaPythonscript">Write a Python script</h1>
		<p>This section explains how you can write your Python4Capella script.</p>
		<h2 id="CreateaPythonproject">Create a Python project</h2>
		<p>We advise that you store your own Python scripts in a separated project. This will prevent some losses when you update Python4Capella.</p>
		<p>You can right click in the new / Project... menu, and select the PyDev project:</p>
		<p>
			<img alt="New PyDev project" title="New PyDev project" border="0" src="Write/New_project.png"/>
		</p>
		<p>You can select a name for your project and click the finish button.</p>
		<p>Now you need to add your project to the list of script locations:</p>
		<p>Select the Window &gt; Preferences menu
			<br/>  - select the Scripting / Script Locations
			<br/>    - add your project by clicking the Add Workspace button
		</p>
		<h2 id="ReferencePython4Capellaproject">Reference Python4Capella project</h2>
		<p>You need to add the Python4Capella project as a dependency of your project. To do so, you need to make sure you are in the PyDev perspective. If it&#8217;s not the case, you can click on the perspective button on the top right corner of your Capella and select the PyDev perspective.
			<br/>Then right click on your project and select the Properties menu. Then select the Project References menu:
		</p>
		<p>
			<img alt="Project preferences" title="Project preferences" border="0" src="Write/Project_preferences.png"/>
		</p>
		<p>You can select the Python4Capella project to add it as a dependency. This way you will be able to access all the Capella APIs defined in the Python4Capella project.</p>
		<h2 id="CreateaPythonscript">Create a Python script</h2>
		<p>To create a Python script in the context of Python4Capella, you first need to create a Python file and then import scripts from Python4Capella.</p>
		<p>Create the Python file by right clicking the container where you want to create the file and select new / other... and select PyDev Module:</p>
		<p>
			<img alt="New PyDev module" title="New PyDev module" border="0" src="Write/New_PyDev_module.png"/>
		</p>
		<p>You can click next, select a name for your script and click finish, you will be asked to select a template, simply click the ok button:</p>
		<p>
			<img alt="New PyDev module template" title="New PyDev module template" border="0" src="Write/New_PyDev_module_template.png"/>
		</p>
		<h2 id="Importrequiredscripts">Import required scripts</h2>
		<p>You will need to import the Capella APIs:</p>
		<pre><code>include('workspace://Python4Capella/simplified_api/capella.py')
if False:
    from simplified_api.capella import *
</code></pre>
		<p>The first line will produce an error because it&#8217;s an EASE instruction that is not understood by PyDev but this will not prevent you from using your script.</p>
		<p>Note: you can find exising examples in 
			<a href="https://github.com/labs4capella/python4capella/tree/master/plugins/Python4Capella/sample_scripts/">Python4Capella/sample_scripts</a>.
		</p>
		<p>You can also configure your Capella to show the line numbers in the PyDev editor. Use the Window Preferences menu, and type line number in the filter:</p>
		<p>
			<img alt="Show line numbers" title="Show line numbers" border="0" src="Write/Show_line_numbers.png"/>
		</p>
		<p>Then you can check the Show line numbers check box.</p>
		<h2 id="InstalledlibrariesintheWindowsPythondistribution">Installed libraries in the Windows Python distribution</h2>
		<p>We packaged openpyxl with the Python37.zip file. You can have a look at provided sample scripts and 
			<a href="https://openpyxl.readthedocs.io/en/stable/">openpyxl project</a> page for usage.
		</p>
	</body>
</html>